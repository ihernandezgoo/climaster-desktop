using System.Globalization;
using System.Windows.Data;
using System.Windows.Media;

namespace climaster.Converters;

public class GradientStringToBrushConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is string gradientString)
        {
            var colors = gradientString.Split(',').Select(c => c.Trim()).ToArray();
            if (colors.Length >= 2)
            {
                var gradientStops = new GradientStopCollection();
                
                for (int i = 0; i < colors.Length; i++)
                {
                    var color = (Color)ColorConverter.ConvertFromString(colors[i]);
                    gradientStops.Add(new GradientStop(color, i / (double)(colors.Length - 1)));
                }

                return new LinearGradientBrush(gradientStops, new System.Windows.Point(0, 0), new System.Windows.Point(0, 1));
            }
        }

        return new LinearGradientBrush(Colors.SkyBlue, Colors.DodgerBlue, 90);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
}

public class UnixTimestampToDateTimeConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is long timestamp)
        {
            var dateTime = DateTimeOffset.FromUnixTimeSeconds(timestamp).LocalDateTime;
            var format = parameter as string ?? "HH:mm";
            return dateTime.ToString(format);
        }
        return string.Empty;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
}

public class BooleanToVisibilityConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is bool boolValue)
        {
            return boolValue ? System.Windows.Visibility.Visible : System.Windows.Visibility.Collapsed;
        }
        return System.Windows.Visibility.Collapsed;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
}
